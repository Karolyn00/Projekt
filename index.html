<!DOCTYPE html>
<html>
<head>
	<title>PROJEKT</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">
	<style type="text/css">
		.nadpis {
			font-family: Papyrus;
			font-size: 50pt; 
			color: white;
			text-decoration: none;
			padding-top: 30pt;}

		.textarea {
			width: 50%;
			height: 500px;
			box-sizing: border-box;
			padding: 10px;
			margin-top: 10px;
			margin-bottom: 10px;
			resize: both;
			font-family: Georgia}

		.flex {
			display: flex;
			justify-content: space-around;
			align-items: flex-end;
			flex-flow: row;
			flex-wrap: wrap;}

		.flex > * {
			width: 100%;}

		@media only screen and (min-width: 500px) {
			.flex > * {
				width: auto;}
	</style>

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous">
		
		function handleSubmit(e) {
			e.preventDefault(); // zabrániť vstavenému odosielaniu v prehliadači
			const ves = this.querySelector("textarea").value; // Načítame text z textarea
			const width = document.querySelector("section:nth-child(2)").clientWidth; // Načítame aktuálnu šírku výstupného okna
			const formular = new URLSearchParams(); // Vytvoríme štruktúru, ktorá bude reprezentovať formulár
			formular.append('ves', ves); // Pridáme tam naše hodnoty
			formular.append('width', width);
			const url = this.action; // Nacitame povodnu URL zadanu vo formulari
			const method = this.method; // NAcitame povodnu metodu zadanu vo formulari
			fetch(url, {method: method, body: formular}) // Urobíme HTTP požiadavku na náš server POST /render a formularom v tele požiadavky
				.then((res) => res.blob()) // Dostali sme binárne dáta (blob)
				.then((image) => {
					document.querySelector("#output").src = URL.createObjectURL(image); // Nastavíme src našeho <img> na načítaný obrázok
				})
		}
		document.querySelector("form").addEventListener("submit", handleSubmit); // Nastavíme formulár, aby pri submit udalosti spustil našu handleSubmit funkciu
	
	</script>
</head>


<body background="https://mypcwalls.com/wp-content/uploads/2021/08/Abstract-Wallpaper.jpg">
	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>

	<script type="text/javascript" src="app.js"></script>

	<center>
		<h1 class="nadpis">Stránka na zobrazovanie súborov ves</h1>
		<form class="form-vertical" action="/render" method="POST">
			<textarea type="text" name="ves" class="textarea" id="ves">Kód súboru...</textarea>
			<br>
			<button>Ukážkový súbor</button>
			<button>Zobraziť obrázok</button>
		</form>
		<img id="output" />
	</center>
</body>
</html>